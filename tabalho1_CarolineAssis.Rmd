---
title: "Descrição e Aplicações na Série Temporal de Prisioneiros em Prisões Federais nos Estado Unidos"
author: "Caroline Assis de Oliveira, 20180011385"
output: pdf_document
---

```{r setup, include=FALSE, echo=F, warning=F, message=F}
knitr::opts_chunk$set(echo = TRUE)
library(expsmooth)
library(fma)
library(forecast)
library(tseries)
library(fpp)
library(aTSA)
```
## Descritivas

O banco que será usado é composto pelas quantidades de encancerados, de ambos os sexos, dividos em Prisões Federais e Prisões Estaduais dos Estado Unidos e por ano, indo de 1990 até 2019. O banco de dados e os sites de onde foram retirados, assim como esse documento podem ser encontrados [clicando aqui](https://github.com/cahssis/ST)

Importando os dados e fazendo uma breve análise descritiva
```{r, warning=F, message=F}
dados = file.choose()
dados = read.table(dados, header = T, sep = ";")
attach(dados)

str(dados)
summary(dados)
```

Podemos verificar com as descritivas que não existe nenhum dado com características que fogem do padrão esperado, e que os dados para prisões estaduais estão mais próximos de ser simétricos do que os dados para as prisões federais. Para este trabalherei apenas com a série temporal de **prisoneiros em prisões federais**.

\newpage{}

## Série Temporal de Prisioneiros em Prisões Federais

Vamos agora aplicar a função 'ts()' para o R entender que esses dados são uma série temporal
```{r}
federal.ts = ts(Federal, start = 1990,end = 2019, frequency = 1)
plot(federal.ts, xlab = "Anos", ylab = "Nº de Prisioneiros")
```

Com o gráfico podemos notar que em geral existe uma tendência crescente de encarcerados em prisões federais ao longo dos anos, porém entre 2010 e 2015 vemos que começa uma queda na série, segundo o BOP (Federal Bureau of Prisons) acredita-se que esses números decairam por conta de algumas políticas de segurança pública em que infratores com sentença não violenta, não séria e que não são infratores sexuais fossem transferidos para prisões locais, e em 2015, onde existe a maior queda, são graças a política de libertação de infratores não-violentos envolvidos em crimes com drogas. Outro motivo de decaimento nos últimos anos da séries podem ser explicadas pelo aumento do número de execuções durante o governo Trump.

Agora iremos fazer algumas análises sobre as autocorrelções destes dados.

```{r}
par(mfrow=c(1,2))
acf(federal.ts, main = "ACF para Federal")
pacf(federal.ts, main = "PACF para Federal")
```
Podemos notar no gráfico acf que as autocorrelações tem uma queda lenta, diferente no observado no gráfico pacf. Agora iremos relizar o teste Phillips-Perron (também conhecido apenas por teste pp) com as seguintes hipóteses:

$H_0:$ Existe pelo menos uma raiz dentro do círculo unitário

$H_1:$ Não existem raízes dentro do círculo unitário

para ver se a série é estacionária ou não, com $\alpha= 0,05$

```{r}
stationary.test(federal.ts, method = "pp")
ndiffs(federal.ts)
```

Pelos p-valores (todos maiores que nosso $\alpha$) temos que essa série não é estacionária, o que corroborado pela função 'ndiffs()', que nos retorna um valor diferente de 0. Quando nos deparamos com esse problema podemos seguir alguna caminhos, aqui seguiremos por dois: **transformação e diferenciação**.

Faremos primeiro a **transformação** dos dados para ver se conseguimos transformar essa série em estacionária.

```{r}
federal.ts_transf = ts(log(Federal), start = 1990, end = 2019, 
                       frequency = 1)
plot(federal.ts_transf)
par(mfrow=c(1,2))
acf(federal.ts_transf, 
    main = "ACF para Federal aplicando\n a transformação log")
pacf(federal.ts_transf, 
     main = "PACF para Federal aplicando\n a transformação log")
stationary.test(federal.ts_transf, method = "pp")
ndiffs(federal.ts_transf)
```

Vemos que com a transformação a série continua com aparente tendência crescente, acf e pacf continuam com as mesmas características, e nosso teste de estacionariedade continua nos indicando que a série não é estacionária.

Então partiremos para a **diferenciação**, o comando 'ndiffs()' nos retorna o valor 2, que no caso é a quantidade de diferenciações que são necessárias para transformar essa série em estacionária, portanto faremos as duas diferenciações seguidas dos testes feitos acima.
```{r}
federal.ts_diff = diff(diff(federal.ts))
plot(federal.ts_diff)
par(mfrow=c(1,2))
acf(federal.ts_diff, 
    main = "ACF para Federal aplicando\n duas diferenciações")
pacf(federal.ts_diff, 
     main = "PACF para Federal aplicando\n duas diferenciações")
stationary.test(federal.ts_diff, method = "pp")
ndiffs(federal.ts_diff)
```

Aplicando as duas diferenciações vemos que a tendência dos nosso dados mudam, não tendo como reconhecer nenhum tipo de tendência. Podemos ver agora que o nosso gráfico acf tem uma queda rápida diferente de antes, e que o teste pp agora nos indica estacionariedade.
